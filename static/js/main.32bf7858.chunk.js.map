{"version":3,"sources":["../../language/dist/index.js","../../algorithm-w/dist/index.js","Main.tsx","index.tsx"],"names":["__extends","this","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","__","constructor","create","defineProperty","exports","value","ParseError","parse","PolyType","TypeFuncApp","TypeVar","Let","Abs","App","Var","NumberLiteral","CharLiteral","parser_1","require","toString","name","fun","arg","func","param","body","def","constructorName","args","_i","arguments","length","map","a","join","quantifiedVars","monoType","v","_super","message","_this","Error","genlex","GenLex","identifier","tokenize","C","charIn","rep","t","charLiteral","stringLiteral","numberLiteral","N","number","backslash","char","arrow","string","lparen","rparen","letTok","equal","inTok","expression","F","try","optApp","LEAF","or","ABS","LET","PAR","expressionNoApp","toCharArray","chars","split","expr","pop","drop","then","lazy","tuple","at","single","parser","expressionPrime","array","nestLeft","optrep","reduce","prev","cur","use","eos","code","forResponse","response","Streams","ofString","isAccepted","repeat","location","__assign","assign","s","i","n","apply","__spreadArrays","il","r","k","j","jl","infer","unify","combine","substitute","TypeInferenceError","language_1","substitution","context","mappedContext","key","substitutions","slice","newSubstitution","type1","type2","_a","contains","JSON","stringify","sub","diff","bset","Set","filter","has","freeVars","type","acc","values","typeCounter","freshTypeName","freshType","_infer","ctx","_b","inst","_c","funcType","funcSubstitution","_d","argType","argSubstitution","unifiedSubstitution","_e","bodyType","bodySubstitution","_f","defType","defSubstitution","_g","generalise","from","to","indexOf","bind","other","some","includes","boolean","f","one","two","extra","list","monoTypes","maybe","either","left","right","c","pt","mt","standardCtx","Main","useState","setCode","result","e","onClick","placeholder","onChange","target","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"0FACA,IAAIA,EAAaC,MAAQA,KAAKD,WAAe,WACzC,IAAIE,EAAgB,SAAUC,EAAGC,GAI7B,OAHAF,EAAgBG,OAAOC,gBAClB,CAAEC,UAAW,cAAgBC,OAAS,SAAUL,EAAGC,GAAKD,EAAEI,UAAYH,IACvE,SAAUD,EAAGC,GAAK,IAAK,IAAIK,KAAKL,EAAOC,OAAOK,UAAUC,eAAeC,KAAKR,EAAGK,KAAIN,EAAEM,GAAKL,EAAEK,MAC3EN,EAAGC,IAE5B,OAAO,SAAUD,EAAGC,GAEhB,SAASS,IAAOZ,KAAKa,YAAcX,EADnCD,EAAcC,EAAGC,GAEjBD,EAAEO,UAAkB,OAANN,EAAaC,OAAOU,OAAOX,IAAMS,EAAGH,UAAYN,EAAEM,UAAW,IAAIG,IAV1C,GAa7CR,OAAOW,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,EAAQE,WAAaF,EAAQG,MAAQH,EAAQI,SAAWJ,EAAQK,YAAcL,EAAQM,QAAUN,EAAQO,IAAMP,EAAQQ,IAAMR,EAAQS,IAAMT,EAAQU,IAAMV,EAAQW,cAAgBX,EAAQY,iBAAc,EACtM,IAAIC,EAAWC,EAAQ,IACnBF,EAA6B,WAC7B,SAASA,EAAYX,GACjBjB,KAAKiB,MAAQA,EAKjB,OAHAW,EAAYnB,UAAUsB,SAAW,WAC7B,OAAO/B,KAAKiB,OAETW,EAPsB,GASjCZ,EAAQY,YAAcA,EACtB,IAAID,EAA+B,WAC/B,SAASA,EAAcV,GACnBjB,KAAKiB,MAAQA,EAKjB,OAHAU,EAAclB,UAAUsB,SAAW,WAC/B,OAAO/B,KAAKiB,MAAMc,YAEfJ,EAPwB,GASnCX,EAAQW,cAAgBA,EACxB,IAAID,EAAqB,WACrB,SAASA,EAAIM,GACThC,KAAKgC,KAAOA,EAKhB,OAHAN,EAAIjB,UAAUsB,SAAW,WACrB,OAAO/B,KAAKgC,MAETN,EAPc,GASzBV,EAAQU,IAAMA,EACd,IAAID,EAAqB,WACrB,SAASA,EAAIQ,EAAKC,GACdlC,KAAKmC,KAAOF,EACZjC,KAAKkC,IAAMA,EAKf,OAHAT,EAAIhB,UAAUsB,SAAW,WACrB,MAAO,IAAM/B,KAAKmC,KAAKJ,WAAa,IAAM/B,KAAKkC,IAAIH,WAAa,KAE7DN,EARc,GAUzBT,EAAQS,IAAMA,EACd,IAAID,EAAqB,WACrB,SAASA,EAAIY,EAAOC,GAChBrC,KAAKoC,MAAQA,EACbpC,KAAKqC,KAAOA,EAKhB,OAHAb,EAAIf,UAAUsB,SAAW,WACrB,MAAO,MAAQ/B,KAAKoC,MAAQ,OAASpC,KAAKqC,KAAKN,WAAa,KAEzDP,EARc,GAUzBR,EAAQQ,IAAMA,EACd,IAAID,EAAqB,WACrB,SAASA,EAAIa,EAAOE,EAAKD,GACrBrC,KAAKoC,MAAQA,EACbpC,KAAKsC,IAAMA,EACXtC,KAAKqC,KAAOA,EAKhB,OAHAd,EAAId,UAAUsB,SAAW,WACrB,MAAO,QAAU/B,KAAKoC,MAAQ,MAAQpC,KAAKsC,IAAIP,WAAa,OAAS/B,KAAKqC,KAAKN,WAAa,KAEzFR,EATc,GAWzBP,EAAQO,IAAMA,EACd,IAAID,EAAyB,WACzB,SAASA,EAAQU,GACbhC,KAAKgC,KAAOA,EAKhB,OAHAV,EAAQb,UAAUsB,SAAW,WACzB,OAAO/B,KAAKgC,MAETV,EAPkB,GAS7BN,EAAQM,QAAUA,EAClB,IAAID,EAA6B,WAC7B,SAASA,EAAYkB,GAEjB,IADA,IAAIC,EAAO,GACFC,EAAK,EAAGA,EAAKC,UAAUC,OAAQF,IACpCD,EAAKC,EAAK,GAAKC,UAAUD,GAE7BzC,KAAKuC,gBAAkBA,EACvBvC,KAAKwC,KAAOA,EAKhB,OAHAnB,EAAYZ,UAAUsB,SAAW,WAC7B,OAAO/B,KAAKuC,iBAAmBvC,KAAKwC,KAAKG,OAAS,IAAM,IAAM3C,KAAKwC,KAAKI,KAAI,SAAUC,GAAK,MAAO,IAAMA,EAAEd,WAAa,OAAQe,KAAK,MAEjIzB,EAZsB,GAcjCL,EAAQK,YAAcA,EACtB,IAAID,EAA0B,WAC1B,SAASA,EAAS2B,EAAgBC,GAC9BhD,KAAK+C,eAAiBA,EACtB/C,KAAKgD,SAAWA,EAKpB,OAHA5B,EAASX,UAAUsB,SAAW,WAC1B,OAAO/B,KAAK+C,eAAeH,KAAI,SAAUK,GAAK,MAAO,SAAMA,KAAMH,KAAK,IAAM,KAAO9C,KAAKgD,SAASjB,YAE9FX,EARmB,GAU9BJ,EAAQI,SAAWA,EAYnB,IAAIF,EAA4B,SAAUgC,GAEtC,SAAShC,EAAWiC,GAChB,IAAIC,EAAQF,EAAOvC,KAAKX,KAAMmD,IAAYnD,KAE1C,OADAoD,EAAMpB,KAAO,aACNoB,EAEX,OANArD,EAAUmB,EAAYgC,GAMfhC,EAPqB,CAQ9BmC,OACFrC,EAAQE,WAAaA,EACrB,IAAIoC,EAAS,IAAIzB,EAAS0B,OACtBC,EAAaF,EAAOG,SAAS5B,EAAS6B,EAAEC,OAAO,8EAA8EC,MAAMhB,KAAI,SAAUiB,GAAK,OAAOA,EAAEf,UAAY,cAC3KgB,EAAcR,EAAOG,SAAS5B,EAAS6B,EAAEI,cAAe,QACxDC,EAAgBT,EAAOG,SAAS5B,EAAS6B,EAAEK,gBAAiB,UAC5DC,EAAgBV,EAAOG,SAAS5B,EAASoC,EAAEC,SAAU,UACrDC,EAAYb,EAAOG,SAAS5B,EAAS6B,EAAEU,KAAK,MAAO,aACnDC,EAAQf,EAAOG,SAAS5B,EAAS6B,EAAEY,OAAO,MAAO,SACjDC,EAASjB,EAAOG,SAAS5B,EAAS6B,EAAEU,KAAK,KAAM,UAC/CI,EAASlB,EAAOG,SAAS5B,EAAS6B,EAAEU,KAAK,KAAM,UAC/CK,EAASnB,EAAOG,SAAS5B,EAAS6B,EAAEY,OAAO,OAAQ,OACnDI,EAAQpB,EAAOG,SAAS5B,EAAS6B,EAAEU,KAAK,KAAM,SAC9CO,EAAQrB,EAAOG,SAAS5B,EAAS6B,EAAEY,OAAO,MAAO,MACjDM,EAAa,WACb,OAAO/C,EAASgD,EAAEC,IAAIC,EAAOC,MACxBC,GAAGpD,EAASgD,EAAEC,IAAIC,EAAOG,OACzBD,GAAGpD,EAASgD,EAAEC,IAAIC,EAAOI,OACzBF,GAAGpD,EAASgD,EAAEC,IAAIC,EAAOK,QAE9BC,EAAkB,WAClB,OAAOxD,EAASgD,EAAEC,IAAIE,KACjBC,GAAGpD,EAASgD,EAAEC,IAAII,MAClBD,GAAGpD,EAASgD,EAAEC,IAAIK,MAClBF,GAAGpD,EAASgD,EAAEC,IAAIM,OAEvBE,EAAc,SAAUhB,GAGxB,IAFA,IAAIiB,EAAQjB,EAAOkB,MAAM,IACrBC,EAAO,IAAI/D,EAAI,MACZ6D,EAAM5C,QACT8C,EAAO,IAAIhE,EAAI,IAAIA,EAAI,IAAIC,EAAI,KAAM,IAAIE,EAAY2D,EAAMG,QAASD,GAExE,OAAOA,GAGPT,EAAO,WAAc,OAAOnD,EAASgD,EAAEC,IAAId,EAAcpB,KAAI,SAAU3B,GAAS,OAAO,IAAIU,EAAcV,OAAYgE,GAAGpD,EAASgD,EAAEC,IAAIf,EAAcnB,IAAI0C,KAAeL,GAAGpD,EAASgD,EAAEC,IAAIhB,EAAYlB,KAAI,SAAU3B,GAAS,OAAO,IAAIW,EAAYX,QAAagE,GAAGpD,EAASgD,EAAEC,IAAItB,EAAWZ,KAAI,SAAU3B,GAAS,OAAO,IAAIS,EAAIT,SACpUiE,EAAM,WAAc,OAAOX,EAAOoB,OAAOC,KAAKzB,EAAUwB,QAAQC,KAAKpC,GAAYoC,KAAKvB,EAAMsB,QAAQC,KAAK/D,EAASgD,EAAEgB,KAAKjB,IAAagB,KAAKpB,EAAOmB,QAAQ/C,KAAI,SAAUkD,GAAS,OAAO,IAAItE,EAAIsE,EAAMC,GAAG,GAAID,EAAMC,GAAG,QACtNX,EAAM,WAAc,OAAOb,EAAOoB,OAAOC,KAAK/D,EAASgD,EAAEgB,KAAKjB,IAAagB,KAAKpB,EAAOmB,QAAQK,UAC/Fb,EAAM,WAAc,OAAOZ,EAAOoB,OAAOC,KAAKnB,EAAOkB,QAAQC,KAAKpC,GAAYoC,KAAKlB,EAAMiB,QAAQC,KAAK/D,EAASgD,EAAEgB,KAAKjB,IAAagB,KAAKjB,EAAMgB,QAAQC,KAAK/D,EAASgD,EAAEgB,KAAKjB,IAAagB,KAAKpB,EAAOmB,QAAQ/C,KAAI,SAAUkD,GAAS,OAAO,IAAIvE,EAAIuE,EAAMC,GAAG,GAAID,EAAMC,GAAG,GAAID,EAAMC,GAAG,QACrRhB,EAAS,SAAUkB,GAAU,OAAOA,EAAOL,KAAKM,KAAmBC,QAAQvD,IAAIwD,IAC/EF,EAAkB,WAAc,OAAOrE,EAASgD,EAAEgB,KAAKR,GAAiBgB,UACxED,EAAW,SAAUnD,GAAK,OAAOA,EAAEqD,QAAO,SAAUC,EAAMC,GAAO,OAAO,IAAI/E,EAAI8E,EAAMC,OACtFP,EAAS3C,EAAOmD,IAAI7B,IAAagB,KAAK/D,EAASgD,EAAE6B,MAAMf,QAAQK,UAUnEhF,EAAQG,MATR,SAAewF,EAAMC,QACG,IAAhBA,IAA0BA,GAAc,GAC5C,IAAIC,EAAWZ,EAAO9E,MAAMU,EAASiF,QAAQC,SAASJ,IACtD,GAAIC,EACA,OAAOC,EACX,GAAIA,EAASG,aACT,OAAOH,EAAS5F,MACpB,MAAM,IAAIC,EAAW,uBAAyByF,EAAO,OAAS,IAAIM,OAAOJ,EAASK,YAAc,O,gCCzLpG,IAAInH,EAAaC,MAAQA,KAAKD,WAAe,WACzC,IAAIE,EAAgB,SAAUC,EAAGC,GAI7B,OAHAF,EAAgBG,OAAOC,gBAClB,CAAEC,UAAW,cAAgBC,OAAS,SAAUL,EAAGC,GAAKD,EAAEI,UAAYH,IACvE,SAAUD,EAAGC,GAAK,IAAK,IAAIK,KAAKL,EAAOC,OAAOK,UAAUC,eAAeC,KAAKR,EAAGK,KAAIN,EAAEM,GAAKL,EAAEK,MAC3EN,EAAGC,IAE5B,OAAO,SAAUD,EAAGC,GAEhB,SAASS,IAAOZ,KAAKa,YAAcX,EADnCD,EAAcC,EAAGC,GAEjBD,EAAEO,UAAkB,OAANN,EAAaC,OAAOU,OAAOX,IAAMS,EAAGH,UAAYN,EAAEM,UAAW,IAAIG,IAV1C,GAazCuG,EAAYnH,MAAQA,KAAKmH,UAAa,WAStC,OARAA,EAAW/G,OAAOgH,QAAU,SAASvD,GACjC,IAAK,IAAIwD,EAAGC,EAAI,EAAGC,EAAI7E,UAAUC,OAAQ2E,EAAIC,EAAGD,IAE5C,IAAK,IAAI9G,KADT6G,EAAI3E,UAAU4E,GACOlH,OAAOK,UAAUC,eAAeC,KAAK0G,EAAG7G,KACzDqD,EAAErD,GAAK6G,EAAE7G,IAEjB,OAAOqD,IAEK2D,MAAMxH,KAAM0C,YAE5B+E,EAAkBzH,MAAQA,KAAKyH,gBAAmB,WAClD,IAAK,IAAIJ,EAAI,EAAGC,EAAI,EAAGI,EAAKhF,UAAUC,OAAQ2E,EAAII,EAAIJ,IAAKD,GAAK3E,UAAU4E,GAAG3E,OACxE,IAAIgF,EAAIpH,MAAM8G,GAAIO,EAAI,EAA3B,IAA8BN,EAAI,EAAGA,EAAII,EAAIJ,IACzC,IAAK,IAAIzE,EAAIH,UAAU4E,GAAIO,EAAI,EAAGC,EAAKjF,EAAEF,OAAQkF,EAAIC,EAAID,IAAKD,IAC1DD,EAAEC,GAAK/E,EAAEgF,GACjB,OAAOF,GAEXvH,OAAOW,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,EAAQwG,MAAQxG,EAAQ+G,MAAQ/G,EAAQgH,MAAQhH,EAAQiH,QAAUjH,EAAQkH,WAAalH,EAAQmH,wBAAqB,EACpH,IAAIC,EAAatG,EAAQ,GACrBqG,EAAoC,SAAUjF,GAE9C,SAASiF,EAAmBhF,GACxB,IAAIC,EAAQF,EAAOvC,KAAKX,KAAMmD,IAAYnD,KAE1C,OADAoD,EAAMpB,KAAO,qBACNoB,EAEX,OANArD,EAAUoI,EAAoBjF,GAMvBiF,EAP6B,CAQtC9E,OAEF,SAAS6E,EAAWG,EAAcnG,GAC9B,IAAIoG,EAAUpG,EACVqG,EAAgB,GACpB,IAAK,IAAIC,KAAOF,EACZC,EAAcC,GAAOhB,EAAMc,EAAQE,GAAMH,GAE7C,OAAOE,EAIX,SAASN,IAEL,IADA,IAAIQ,EAAgB,GACXhG,EAAK,EAAGA,EAAKC,UAAUC,OAAQF,IACpCgG,EAAchG,GAAMC,UAAUD,GAElC,GAA6B,IAAzBgG,EAAc9F,OACd,MAAO,GACX,GAA6B,IAAzB8F,EAAc9F,OACd,OAAO8F,EAAc,GACzB,GAAIA,EAAc9F,OAAS,EACvB,OAAOsF,EAAQQ,EAAc,GAAIR,EAAQT,WAAM,EAAQiB,EAAcC,MAAM,KAC/E,IAAI7F,EAAI4F,EAAc,GAClBtI,EAAIsI,EAAc,GAClBE,EAAkB,GACtB,IAAK,IAAIH,KAAO3F,EACZ8F,EAAgBH,GAAOhB,EAAM3E,EAAE2F,GAAMrI,GAEzC,IAAK,IAAIqI,KAAOrI,EACNqI,KAAO3F,IACT8F,EAAgBH,GAAOrI,EAAEqI,IAGjC,OAAOG,EAGX,SAASX,EAAMY,EAAOC,GAClB,IAAIC,EACJ,GAAIF,aAAiBR,EAAW9G,QAAS,CACrC,GAAIyH,EAASF,EAAOD,GAChB,MAAM,IAAIT,EAAmB,qCAAuCa,KAAKC,UAAUL,GAAS,QAAUI,KAAKC,UAAUJ,IAEzH,OAAOC,EAAK,IAAOF,EAAM5G,MAAQ6G,EAAOC,EAE5C,GAAID,aAAiBT,EAAW9G,QAC5B,OAAO0G,EAAMa,EAAOD,GAExB,GAAIA,aAAiBR,EAAW/G,aAAewH,aAAiBT,EAAW/G,YAAa,CACpF,GAAIuH,EAAMrG,kBAAoBsG,EAAMtG,gBAChC,MAAM,IAAI4F,EAAmB,2EAA8ES,EAAMrG,gBAAkB,UAAcsG,EAAMtG,gBAAkB,KAE7K,GAAIqG,EAAMpG,KAAKG,SAAWkG,EAAMrG,KAAKG,OACjC,MAAM,IAAIwF,EAAmB,mFAAqFa,KAAKC,UAAUL,GAAS,QAAUI,KAAKC,UAAUJ,IAGvK,IADA,IAAIK,EAAM,GACD5B,EAAI,EAAGA,EAAIsB,EAAMpG,KAAKG,OAAQ2E,IACnC4B,EAAMjB,EAAQD,EAAMR,EAAMoB,EAAMpG,KAAK8E,GAAI4B,GAAM1B,EAAMqB,EAAMrG,KAAK8E,GAAI4B,IAAOA,GAE/E,OAAOA,EAGX,MAAM,IAAI7F,MAAM,4CAIpB,SAAS8F,EAAKtG,EAAG1C,GACb,IAAIiJ,EAAO,IAAIC,IAAIlJ,GACnB,OAAO0C,EAAEyG,QAAO,SAAUrG,GAAK,OAAQmG,EAAKG,IAAItG,MAEpD,SAASuG,EAASC,GACd,GAAIA,aAAgBrB,EAAWhH,SAC3B,OAAO+H,EAAKK,EAASC,EAAKzG,UAAWyG,EAAK1G,gBAE9C,GAAI0G,aAAgBrB,EAAW9G,QAC3B,MAAO,CAACmI,EAAKzH,MAEjB,GAAIyH,aAAgBrB,EAAW/G,YAC3B,OAAOoI,EAAKjH,KAAKI,IAAI4G,GAAUlD,QAAO,SAAUoD,EAAKlD,GAAO,OAAOiB,EAAeiC,EAAKlD,KAAS,IAEpG,GAAIiD,EAEA,OAAOrJ,OAAOuJ,OAAOF,GAAM7G,IAAI4G,GAAUlD,QAAO,SAAUoD,EAAKlD,GAAO,OAAOiB,EAAeiC,EAAKlD,KAAS,IAG9G,MAAM,IAAInD,MAAM,4CApFpBrC,EAAQmH,mBAAqBA,EAS7BnH,EAAQkH,WAAaA,EA0BrBlH,EAAQiH,QAAUA,EA4BlBjH,EAAQgH,MAAQA,EA0BhB,IAAI4B,EAAc,EAClB,SAASC,IACL,MAAO,IAAMD,IAEjB,SAASE,IACL,OAAO,IAAI1B,EAAW9G,QAAQuI,KAQlC,SAASE,EAAOtE,EAAMuE,GAClB,IAAIlB,EAAImB,EACR,GAAIxE,aAAgB2C,EAAWxG,YAC3B,MAAO,CAACsI,EAAK,IAAI9B,EAAWhH,SAAS,GAAI,IAAIgH,EAAW/G,YAAY,UAAW,IAEnF,GAAIoE,aAAgB2C,EAAWzG,cAC3B,MAAO,CAACuI,EAAK,IAAI9B,EAAWhH,SAAS,GAAI,IAAIgH,EAAW/G,YAAY,YAAa,IAErF,GAAIoE,aAAgB2C,EAAW1G,IAAK,CAChC,IAAI+H,EAAOO,EAAIvE,EAAKzD,MACpB,IAAKyH,EACD,MAAM,IAAItB,EAAmB1C,EAAKzD,KAAO,oBAE7C,MAAO,CAACkI,EAAKT,GAAO,IAExB,GAAIhE,aAAgB2C,EAAW3G,IAAK,CAChC,IAAI0I,EAAKJ,EAAOtE,EAAKtD,KAAM6H,GAAMI,EAAWD,EAAG,GAAIE,EAAmBF,EAAG,GACrEG,EAAKP,EAAOtE,EAAKvD,IAAKgG,EAAWmC,EAAkBL,IAAOO,EAAUD,EAAG,GAAIE,EAAkBF,EAAG,GAChGzG,EAAIiG,IACJW,EAAsBzC,EAAMR,EAAM4C,EAAUI,GAAkB,IAAIpC,EAAW/G,YAAY,KAAMkJ,EAAS1G,IAC5G,MAAO,CAAC2D,EAAM3D,EAAG4G,GAAsBxC,EAAQoC,EAAkBG,EAAiBC,IAEtF,GAAIhF,aAAgB2C,EAAW5G,IAAK,CAC5BqC,EAAIiG,IAAR,IACIY,EAAKX,EAAOtE,EAAKpD,KAAM8E,EAASA,EAAS,GAAI6C,KAAOlB,EAAK,IAAOrD,EAAKrD,OAAS,IAAIgG,EAAWhH,SAAS,GAAIyC,GAAIiF,KAAO6B,EAAWD,EAAG,GAAIE,EAAmBF,EAAG,GACjK,MAAO,CAAClD,EAAM,IAAIY,EAAW/G,YAAY,KAAMwC,EAAG8G,GAAWC,GAAmBA,GAEpF,GAAInF,aAAgB2C,EAAW7G,IAAK,CAChC,IAAIsJ,EAAKd,EAAOtE,EAAKnD,IAAK0H,GAAMc,EAAUD,EAAG,GAAIE,EAAkBF,EAAG,GAClEG,EAAKjB,EAAOtE,EAAKpD,KAAM8E,EAASA,EAAS,GAAIe,EAAW6C,EAAiBf,MAAQC,EAAK,IAAOxE,EAAKrD,OA7C9G,SAAoB4H,EAAKP,GACrB,OAAO,IAAIrB,EAAWhH,SAAS+H,EAAKK,EAASC,GAAOD,EAASQ,IAAOP,GA4C+CwB,CAAW/C,EAAW6C,EAAiBf,GAAMc,GAAUb,KACtK,MAAO,CADsKU,EAAWK,EAAG,GACzK/C,EAAQ8C,EADqKH,EAAmBI,EAAG,KAIzN,MAAM,IAAI3H,MAAM,4CAEpB,SAAS6G,EAAKT,EAAMyB,EAAMC,GAGtB,QAFa,IAATD,IAAmBA,EAAO,SACnB,IAAPC,IAAiBA,EAAK,IACtB1B,aAAgBrB,EAAW9G,QAAS,CACpC,IAAIgG,EAAI4D,EAAKE,QAAQ3B,EAAKzH,MAC1B,OAAe,IAAPsF,EAAYmC,EAAO,IAAIrB,EAAW9G,QAAQ6J,EAAG7D,IAEzD,GAAImC,aAAgBrB,EAAW/G,YAC3B,OAAO,IAAK+G,EAAW/G,YAAYgK,KAAK7D,MAAMY,EAAW/G,YAAaoG,EAAe,MAAC,EAAQgC,EAAKlH,iBAAkBkH,EAAKjH,KAAKI,KAAI,SAAUV,GAAO,OAAOgI,EAAKhI,EAAKgJ,EAAMC,SAE/K,GAAI1B,aAAgBrB,EAAWhH,SAC3B,OAAO8I,EAAKT,EAAKzG,SAAUyG,EAAK1G,eAAgB0G,EAAK1G,eAAeH,IAAIiH,IAG5E,MAAM,IAAIxG,MAAM,4CAEpB,SAASmE,EAAMiC,EAAMpB,GACjB,GAAIoB,aAAgBrB,EAAW9G,QAC3B,OAAOmI,EAAKzH,QAAQqG,EAAeA,EAAaoB,EAAKzH,MAAQyH,EAEjE,GAAIA,aAAgBrB,EAAW/G,YAC3B,OAAO,IAAK+G,EAAW/G,YAAYgK,KAAK7D,MAAMY,EAAW/G,YAAaoG,EAAe,MAAC,EAAQgC,EAAKlH,iBAAkBkH,EAAKjH,KAAKI,KAAI,SAAUV,GAAO,OAAOsF,EAAMtF,EAAKmG,SAE1K,GAAIoB,aAAgBrB,EAAWhH,SAC3B,OAAO,IAAIgH,EAAWhH,SAASqI,EAAK1G,eAAgByE,EAAMiC,EAAKzG,SAAUqF,IAG7E,MAAM,IAAIhF,MAAM,4CAGpB,SAAS0F,EAASU,EAAM6B,GACpB,GAAI7B,aAAgBrB,EAAW9G,QAC3B,OAAOmI,EAAKzH,MAAQsJ,EAAMtJ,KAE9B,GAAIyH,aAAgBrB,EAAW/G,YAC3B,OAAOoI,EAAKjH,KAAK+I,MAAK,SAAUrJ,GAAO,OAAO6G,EAAS7G,EAAKoJ,MAEhE,GAAI7B,aAAgBrB,EAAWhH,SAC3B,OAAO2H,EAASU,EAAKzG,SAAUsI,KAAW7B,EAAK1G,eAAeyI,SAASF,EAAMtJ,MAGjF,MAAM,IAAIqB,MAAM,4CA7EpBrC,EAAQ+G,MAJR,SAAetC,EAAMuE,GAEjB,YADY,IAARA,IAAkBA,EAAM,IACrBD,EAAOtE,EAAMuE,GAAK,IAmE7BhJ,EAAQwG,MAAQA,G,uJC/LHtD,EAAS,IAAI7C,cAAY,UACzBoK,EAAU,IAAIpK,cAAY,WAC1BqK,EAAI,SAAJA,EAAKC,EAAeC,GAAsD,IAAD,uBAAnCC,EAAmC,iCAAnCA,EAAmC,kBAClF,OAAqB,IAAjBA,EAAMlJ,OAAqB,IAAItB,cAAY,KAAMsK,EAAKC,GACnD,IAAIvK,cAAY,KAAMsK,EAAKD,EAAC,WAAD,GAAEE,EAAKC,EAAM,IAAb,mBAAoBA,EAAMnD,MAAM,QAEzDoD,EAAO,SAAC9I,GAAD,OAAqC,IAAI3B,cAAY,KAAM2B,IAClE8C,EAAQ,WAA4C,IAAD,uBAAvCiG,EAAuC,yBAAvCA,EAAuC,gBAC5D,GAAIA,EAAUpJ,QAAU,EAAG,MAAM,IAAIU,MAAM,sDAAwD0I,EAAUpJ,QAC7G,GAAIoJ,EAAUpJ,OAAS,EAAG,MAAM,IAAIU,MAAM,uDAAyD0I,EAAUpJ,QAC7G,OAAO,YAAItB,cAAX,CAAuB,IAAI4F,OAAO8E,EAAUpJ,OAAS,IAArD,OAAwEoJ,KAE/DC,EAAQ,SAAChJ,GAAD,OAAqC,IAAI3B,cAAY,QAAS2B,IACtEiJ,EAAS,SAACC,EAAgBC,GAAjB,OAAkD,IAAI9K,cAAY,SAAU6K,EAAMC,IAE3FtJ,EAAI,IAAIvB,UAAQ,KAChBnB,EAAI,IAAImB,UAAQ,KAChB8K,EAAI,IAAI9K,UAAQ,KAChBpB,EAAI,IAAIoB,UAAQ,KACvB+K,EAAK,SAACC,GAAD,OAAkB,IAAIlL,WAAS,GAAIkL,IAGjCC,EAAuB,CAElC,IAAKF,EAAGX,EAAExH,EAAQA,EAAQA,IAC1B,IAAKmI,EAAGX,EAAExH,EAAQA,EAAQA,IAC1B,IAAKmI,EAAGX,EAAExH,EAAQA,EAAQA,IAC1B,IAAKmI,EAAGX,EAAExH,EAAQA,EAAQA,IAC1B,IAAKmI,EAAGX,EAAExH,EAAQA,EAAQA,IAC1B,OAAUmI,EAAGX,EAAExH,EAAQA,IACvB,IAAOmI,EAAGX,EAAExH,EAAQA,IACpB,OAAUmI,EAAGX,EAAExH,EAAQA,IACvB,KAAQmI,EAAGX,EAAExH,EAAQuH,IACrB,IAAOY,EAAGX,EAAExH,EAAQuH,IAGpB,IAAOY,EAAGX,EAAED,EAASA,IACrB,KAAMY,EAAGX,EAAED,EAASA,EAASA,IAC7B,KAAMY,EAAGX,EAAED,EAASA,EAASA,IAC7B,KAAQY,EAAGZ,GACX,MAASY,EAAGZ,GAGZ,SAAYY,EAAGnI,GACf,UAAamI,EAAGZ,GAGhB,KAAM,IAAIrK,WAAS,CAAC,KAAM0K,EAAKjJ,IAC/B,IAAK,IAAIzB,WAAS,CAAC,KAAMsK,EAAE7I,EAAGiJ,EAAKjJ,GAAIiJ,EAAKjJ,KAC5C,KAAQ,IAAIzB,WAAS,CAAC,KAAMsK,EAAE7I,EAAGiJ,EAAKjJ,GAAIiJ,EAAKjJ,KAC/C,KAAM,IAAIzB,WAAS,CAAC,KAAMsK,EAAEI,EAAKjJ,GAAIiJ,EAAKjJ,GAAIiJ,EAAKjJ,KACnD,KAAQ,IAAIzB,WAAS,CAAC,KAAMsK,EAAEI,EAAKjJ,GAAIA,IACvC,KAAQ,IAAIzB,WAAS,CAAC,KAAMsK,EAAEI,EAAKjJ,GAAIA,IACvC,KAAQ,IAAIzB,WAAS,CAAC,KAAMsK,EAAEI,EAAKjJ,GAAIiJ,EAAKjJ,KAC5C,KAAQ,IAAIzB,WAAS,CAAC,KAAMsK,EAAEI,EAAKjJ,GAAIiJ,EAAKjJ,KAC5C,OAAU,IAAIzB,WAAS,CAAC,KAAMsK,EAAEI,EAAKjJ,GAAImJ,EAAMlG,EAAMjD,EAAGiJ,EAAKjJ,OAC7D,KAAQ,IAAIzB,WAAS,CAAC,KAAMsK,EAAEI,EAAKjJ,GAAI4I,IACvC,OAAU,IAAIrK,WAAS,CAAC,KAAMsK,EAAEI,EAAKjJ,GAAIqB,IACzC,IAAO,IAAI9C,WAAS,CAAC,IAAK,KAAMsK,EAAEA,EAAE7I,EAAG1C,GAAI2L,EAAKjJ,GAAIiJ,EAAK3L,KACzD,QAAW,IAAIiB,WAAS,CAAC,KAAMsK,EAAEI,EAAKjJ,GAAIiJ,EAAKjJ,KAC/C,YAAe,IAAIzB,WAAS,CAAC,KAAMsK,EAAE7I,EAAGiJ,EAAKjJ,GAAIiJ,EAAKjJ,KACtD,YAAe,IAAIzB,WAAS,CAAC,KAAMsK,EAAEI,EAAKjJ,GAAIiJ,EAAKA,EAAKjJ,IAAKiJ,EAAKjJ,KAClE,UAAa,IAAIzB,WAAS,CAAC,KAAMsK,EAAEI,EAAKA,EAAKjJ,IAAKiJ,EAAKA,EAAMjJ,MAC7D,aAAgB,IAAIzB,WAAS,CAAC,KAAMsK,EAAEI,EAAKjJ,GAAIiJ,EAAKA,EAAMjJ,MAC1D,aAAgB,IAAIzB,WAAS,CAAC,KAAMsK,EAAEI,EAAKjJ,GAAIiJ,EAAKA,EAAMjJ,MAC1D,MAAS,IAAIzB,WAAS,CAAC,KAAMsK,EAAEA,EAAEvL,EAAG0C,EAAG1C,GAAIA,EAAG2L,EAAKjJ,GAAI1C,IACvD,SAAW,IAAIiB,WAAS,CAAC,KAAMsK,EAAEA,EAAEvL,EAAG0C,EAAG1C,GAAIA,EAAG2L,EAAKjJ,GAAI1C,IACzD,OAAU,IAAIiB,WAAS,CAAC,KAAMsK,EAAEA,EAAE7I,EAAGA,EAAGA,GAAIiJ,EAAKjJ,GAAIA,IACrD,UAAY,IAAIzB,WAAS,CAAC,KAAMsK,EAAEA,EAAE7I,EAAGA,EAAGA,GAAIiJ,EAAKjJ,GAAIA,IACvD,MAAS,IAAIzB,WAAS,CAAC,KAAMsK,EAAEA,EAAE7I,EAAG1C,EAAGA,GAAIA,EAAG2L,EAAKjJ,GAAI1C,IACvD,OAAU,IAAIiB,WAAS,CAAC,KAAMsK,EAAEA,EAAE7I,EAAGA,EAAGA,GAAIiJ,EAAKjJ,GAAIA,IACrD,OAAU,IAAIzB,WAAS,CAAC,KAAMsK,EAAEI,EAAKA,EAAKjJ,IAAKiJ,EAAKjJ,KACpD,UAAa,IAAIzB,WAAS,CAAC,KAAMsK,EAAEA,EAAE7I,EAAGiJ,EAAKjJ,IAAKiJ,EAAKjJ,GAAIiJ,EAAK3L,KAChE,IAAOkM,EAAGX,EAAEI,EAAKL,GAAUA,IAC3B,GAAMY,EAAGX,EAAEI,EAAKL,GAAUA,IAC1B,IAAO,IAAIrK,WAAS,CAAC,KAAMsK,EAAEA,EAAE7I,EAAG4I,GAAUK,EAAKjJ,GAAI4I,IACrD,IAAO,IAAIrK,WAAS,CAAC,KAAMsK,EAAEA,EAAE7I,EAAG4I,GAAUK,EAAKjJ,GAAI4I,IACrD,IAAOY,EAAGX,EAAEI,EAAK5H,GAASA,IAC1B,QAAWmI,EAAGX,EAAEI,EAAK5H,GAASA,IAC9B,QAAWmI,EAAGX,EAAEI,EAAK5H,GAASA,IAC9B,QAAWmI,EAAGX,EAAEI,EAAK5H,GAASA,IAC9B,KAAQ,IAAI9C,WAAS,CAAC,KAAMsK,EAAExH,EAAQ4H,EAAKjJ,GAAIiJ,EAAKjJ,KACpD,KAAQ,IAAIzB,WAAS,CAAC,KAAMsK,EAAExH,EAAQ4H,EAAKjJ,GAAIiJ,EAAKjJ,KACpD,QAAW,IAAIzB,WAAS,CAAC,KAAMsK,EAAExH,EAAQ4H,EAAKjJ,GAAIiD,EAAMgG,EAAKjJ,GAAIiJ,EAAKjJ,MACtE,UAAa,IAAIzB,WAAS,CAAC,KAAMsK,EAAEA,EAAE7I,EAAG4I,GAAUK,EAAKjJ,GAAIiJ,EAAKjJ,KAChE,UAAa,IAAIzB,WAAS,CAAC,KAAMsK,EAAEA,EAAE7I,EAAG4I,GAAUK,EAAKjJ,GAAIiJ,EAAKjJ,KAChE,KAAQ,IAAIzB,WAAS,CAAC,KAAMsK,EAAE7I,EAAGiJ,EAAKjJ,GAAI4I,IAC1C,QAAW,IAAIrK,WAAS,CAAC,KAAMsK,EAAE7I,EAAGiJ,EAAKjJ,GAAI4I,IAC7C,OAAU,IAAIrK,WAAS,CAAC,IAAK,KAAMsK,EAAE7I,EAAGiJ,EAAKhG,EAAMjD,EAAG1C,IAAK6L,EAAM7L,KACjE,KAAQ,IAAIiB,WAAS,CAAC,KAAMsK,EAAEA,EAAE7I,EAAG4I,GAAUK,EAAKjJ,GAAImJ,EAAMnJ,KAC5D,OAAU,IAAIzB,WAAS,CAAC,KAAMsK,EAAEA,EAAE7I,EAAG4I,GAAUK,EAAKjJ,GAAIiJ,EAAKjJ,KAC7D,UAAa,IAAIzB,WAAS,CAAC,KAAMsK,EAAEA,EAAE7I,EAAG4I,GAAUK,EAAKjJ,GAAIiD,EAAMgG,EAAKjJ,GAAIiJ,EAAKjJ,MAC/E,KAAM,IAAIzB,WAAS,CAAC,KAAMsK,EAAEI,EAAKjJ,GAAIqB,EAAQrB,IAC7C,IAAO,IAAIzB,WAAS,CAAC,IAAK,KAAMsK,EAAEI,EAAKjJ,GAAIiJ,EAAK3L,GAAI2L,EAAKhG,EAAMjD,EAAG1C,MAClE,QAAW,IAAIiB,WAAS,CAAC,IAAK,IAAK,KAAMsK,EAAEA,EAAE7I,EAAG1C,EAAGiM,GAAIN,EAAKjJ,GAAIiJ,EAAK3L,GAAI2L,EAAKM,KAC9E,MAAS,IAAIhL,WAAS,CAAC,IAAK,KAAMsK,EAAEI,EAAKhG,EAAMjD,EAAG1C,IAAK2F,EAAMgG,EAAKjJ,GAAIiJ,EAAK3L,MAC3E,IAAO,IAAIiB,WAAS,CAAC,KAAMsK,EAAEI,EAAKjJ,GAAIiJ,EAAKjJ,KAC3C,OAAU,IAAIzB,WAAS,CAAC,KAAMsK,EAAE7I,EAAGiJ,EAAKjJ,GAAIiJ,EAAKjJ,KACjD,OAAQ,IAAIzB,WAAS,CAAC,KAAMsK,EAAEI,EAAKjJ,GAAIiJ,EAAKjJ,GAAIiJ,EAAKjJ,KACrD,MAAS,IAAIzB,WAAS,CAAC,KAAMsK,EAAEI,EAAKjJ,GAAIiJ,EAAKjJ,GAAIiJ,EAAKjJ,KACtD,UAAa,IAAIzB,WAAS,CAAC,KAAMsK,EAAEI,EAAKjJ,GAAIiJ,EAAKjJ,GAAIiJ,EAAKjJ,KAC1D,KAAQ,IAAIzB,WAAS,CAAC,KAAMsK,EAAEI,EAAKjJ,GAAIiJ,EAAKjJ,KAG5C,IAAK,IAAIzB,WAAS,CAAC,IAAK,KAAMsK,EAAE7I,EAAG1C,EAAG2F,EAAMjD,EAAG1C,KAC/C,KAAM,IAAIiB,WAAS,CAAC,IAAK,IAAK,KAAMsK,EAAE7I,EAAG1C,EAAGiM,EAAGtG,EAAMjD,EAAG1C,EAAGiM,KAC3D,MAAO,IAAIhL,WAAS,CAAC,IAAK,IAAK,IAAK,KAAMsK,EAAE7I,EAAG1C,EAAGiM,EAAGlM,EAAG4F,EAAMjD,EAAG1C,EAAGiM,EAAGlM,KACvE,IAAO,IAAIkB,WAAS,CAAC,IAAK,KAAMsK,EAAE5F,EAAMjD,EAAG1C,GAAI0C,IAC/C,IAAO,IAAIzB,WAAS,CAAC,IAAK,KAAMsK,EAAE5F,EAAMjD,EAAG1C,GAAIA,IAC/C,MAAS,IAAIiB,WAAS,CAAC,IAAK,IAAK,KAAMsK,EAAEA,EAAE5F,EAAMjD,EAAG1C,GAAIiM,GAAIvJ,EAAG1C,EAAGiM,IAClE,QAAW,IAAIhL,WAAS,CAAC,IAAK,IAAK,KAAMsK,EAAEA,EAAE7I,EAAG1C,EAAGiM,GAAItG,EAAMjD,EAAG1C,GAAIiM,IAGpE,KAAQ,IAAIhL,WAAS,CAAC,KAAMsK,EAAE7I,EAAGmJ,EAAMnJ,KACvC,QAAW,IAAIzB,WAAS,CAAC,KAAM4K,EAAMnJ,IAGrC,KAAQ,IAAIzB,WAAS,CAAC,IAAK,KAAMsK,EAAE7I,EAAGoJ,EAAOpJ,EAAG1C,KAChD,MAAS,IAAIiB,WAAS,CAAC,IAAK,KAAMsK,EAAEvL,EAAG8L,EAAOpJ,EAAG1C,MA0CpCqM,MAvCf,WAAiB,IAAD,EACUC,mBAAS,cADnB,mBACP9F,EADO,KACD+F,EADC,KAEVC,EAAS,UACb,IACE,IAAMhF,EAAIxG,gBAAMwF,GAChB,KAAMgB,aAAa/F,kBAAkB+F,aAAahG,oBAAoBgG,aAAajG,UAAUiG,aAAalG,UAAUkG,aAAanG,UAAUmG,aAAapG,OACtJ,MAAM,IAAI8B,MAAM,0BAElBsJ,EAAS5E,gBAAMJ,EAAG4E,GAAaxK,WAC/B,MAAO6K,GACHA,EAAE5K,OAASmG,qBAAmBnG,MAEvB4K,EAAE5K,OAASd,aAAWc,KAD/B2K,GAAWC,EAAyBzJ,QAIpCwJ,GAAU,2BAA6BC,EAAEzJ,QAI7C,OACE,qCACE,4DACA,wEAGA,0CACE,wBAAQ0J,QAAS,kBAAMH,EAAQ,MAA/B,eACA,wBAAQG,QAAS,kBAAMH,EAAQ,MAA/B,eACA,wBAAQG,QAAS,kBAAMH,EAAQ,eAA/B,wBACA,wBAAQG,QAAS,kBAAMH,EAAQ,QAA/B,iBACA,wBAAQG,QAAS,kBAAMH,EAAQ,SAA/B,qBAEF,0BAAUI,YAAY,qBAAqB7L,MAAO0F,EAAMoG,SAAU,SAAAH,GAAC,OAAIF,EAAQE,EAAEI,OAAO/L,UACxF,wCACA,4BAAI0L,QC1KVM,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEFC,SAASC,eAAe,W","file":"static/js/main.32bf7858.chunk.js","sourcesContent":["\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ParseError = exports.parse = exports.PolyType = exports.TypeFuncApp = exports.TypeVar = exports.Let = exports.Abs = exports.App = exports.Var = exports.NumberLiteral = exports.CharLiteral = void 0;\nvar parser_1 = require(\"@masala/parser\");\nvar CharLiteral = /** @class */ (function () {\n    function CharLiteral(value) {\n        this.value = value;\n    }\n    CharLiteral.prototype.toString = function () {\n        return this.value;\n    };\n    return CharLiteral;\n}());\nexports.CharLiteral = CharLiteral;\nvar NumberLiteral = /** @class */ (function () {\n    function NumberLiteral(value) {\n        this.value = value;\n    }\n    NumberLiteral.prototype.toString = function () {\n        return this.value.toString();\n    };\n    return NumberLiteral;\n}());\nexports.NumberLiteral = NumberLiteral;\nvar Var = /** @class */ (function () {\n    function Var(name) {\n        this.name = name;\n    }\n    Var.prototype.toString = function () {\n        return this.name;\n    };\n    return Var;\n}());\nexports.Var = Var;\nvar App = /** @class */ (function () {\n    function App(fun, arg) {\n        this.func = fun;\n        this.arg = arg;\n    }\n    App.prototype.toString = function () {\n        return '(' + this.func.toString() + ' ' + this.arg.toString() + ')';\n    };\n    return App;\n}());\nexports.App = App;\nvar Abs = /** @class */ (function () {\n    function Abs(param, body) {\n        this.param = param;\n        this.body = body;\n    }\n    Abs.prototype.toString = function () {\n        return '(\\\\' + this.param + ' -> ' + this.body.toString() + ')';\n    };\n    return Abs;\n}());\nexports.Abs = Abs;\nvar Let = /** @class */ (function () {\n    function Let(param, def, body) {\n        this.param = param;\n        this.def = def;\n        this.body = body;\n    }\n    Let.prototype.toString = function () {\n        return '(let ' + this.param + ' = ' + this.def.toString() + ' in ' + this.body.toString() + ')';\n    };\n    return Let;\n}());\nexports.Let = Let;\nvar TypeVar = /** @class */ (function () {\n    function TypeVar(name) {\n        this.name = name;\n    }\n    TypeVar.prototype.toString = function () {\n        return this.name;\n    };\n    return TypeVar;\n}());\nexports.TypeVar = TypeVar;\nvar TypeFuncApp = /** @class */ (function () {\n    function TypeFuncApp(constructorName) {\n        var args = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            args[_i - 1] = arguments[_i];\n        }\n        this.constructorName = constructorName;\n        this.args = args;\n    }\n    TypeFuncApp.prototype.toString = function () {\n        return this.constructorName + (this.args.length ? ' ' : '') + this.args.map(function (a) { return '(' + a.toString() + ')'; }).join(' ');\n    };\n    return TypeFuncApp;\n}());\nexports.TypeFuncApp = TypeFuncApp;\nvar PolyType = /** @class */ (function () {\n    function PolyType(quantifiedVars, monoType) {\n        this.quantifiedVars = quantifiedVars;\n        this.monoType = monoType;\n    }\n    PolyType.prototype.toString = function () {\n        return this.quantifiedVars.map(function (v) { return 'âˆ€' + v; }).join('') + ': ' + this.monoType.toString();\n    };\n    return PolyType;\n}());\nexports.PolyType = PolyType;\n/* Parser */\n// expr ::= identifier # var\n//        | ( \\ identifier -> expr ) # abs\n//        | ( expr )\n//        | expr expr # app\n//        | ( let identifier = expr in expr ) # let\n// expr ::= identifier expr' # var\n//        | ( \\ identifier -> expr ) expr' # abs\n//        | ( expr ) expr'\n//        | ( let identifier = expr in expr ) expr' # let\n// expr' ::= expr A' | eps # app\nvar ParseError = /** @class */ (function (_super) {\n    __extends(ParseError, _super);\n    function ParseError(message) {\n        var _this = _super.call(this, message) || this;\n        _this.name = \"ParseError\";\n        return _this;\n    }\n    return ParseError;\n}(Error));\nexports.ParseError = ParseError;\nvar genlex = new parser_1.GenLex();\nvar identifier = genlex.tokenize(parser_1.C.charIn('abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789*+-/%<>^:[]_').rep().map(function (t) { return t.join(); }), 'identifier');\nvar charLiteral = genlex.tokenize(parser_1.C.charLiteral(), 'char');\nvar stringLiteral = genlex.tokenize(parser_1.C.stringLiteral(), 'string');\nvar numberLiteral = genlex.tokenize(parser_1.N.number(), 'number');\nvar backslash = genlex.tokenize(parser_1.C.char('\\\\'), 'backslash');\nvar arrow = genlex.tokenize(parser_1.C.string('->'), 'arrow');\nvar lparen = genlex.tokenize(parser_1.C.char('('), 'lparen');\nvar rparen = genlex.tokenize(parser_1.C.char(')'), 'rparen');\nvar letTok = genlex.tokenize(parser_1.C.string('let'), 'let');\nvar equal = genlex.tokenize(parser_1.C.char('='), 'equal');\nvar inTok = genlex.tokenize(parser_1.C.string('in'), 'in');\nvar expression = function () {\n    return parser_1.F.try(optApp(LEAF()))\n        .or(parser_1.F.try(optApp(ABS())))\n        .or(parser_1.F.try(optApp(LET())))\n        .or(parser_1.F.try(optApp(PAR())));\n};\nvar expressionNoApp = function () {\n    return parser_1.F.try(LEAF())\n        .or(parser_1.F.try(ABS()))\n        .or(parser_1.F.try(LET()))\n        .or(parser_1.F.try(PAR()));\n};\nvar toCharArray = function (string) {\n    var chars = string.split('');\n    var expr = new Var('[]');\n    while (chars.length) {\n        expr = new App(new App(new Var(':'), new CharLiteral(chars.pop())), expr);\n    }\n    return expr;\n};\n// We have to SHOUT as var and let are restricted keywords in JavaScript\nvar LEAF = function () { return parser_1.F.try(numberLiteral.map(function (value) { return new NumberLiteral(value); })).or(parser_1.F.try(stringLiteral.map(toCharArray))).or(parser_1.F.try(charLiteral.map(function (value) { return new CharLiteral(value); }))).or(parser_1.F.try(identifier.map(function (value) { return new Var(value); }))); };\nvar ABS = function () { return lparen.drop().then(backslash.drop()).then(identifier).then(arrow.drop()).then(parser_1.F.lazy(expression)).then(rparen.drop()).map(function (tuple) { return new Abs(tuple.at(0), tuple.at(1)); }); };\nvar PAR = function () { return lparen.drop().then(parser_1.F.lazy(expression)).then(rparen.drop()).single(); };\nvar LET = function () { return lparen.drop().then(letTok.drop()).then(identifier).then(equal.drop()).then(parser_1.F.lazy(expression)).then(inTok.drop()).then(parser_1.F.lazy(expression)).then(rparen.drop()).map(function (tuple) { return new Let(tuple.at(0), tuple.at(1), tuple.at(2)); }); };\nvar optApp = function (parser) { return parser.then(expressionPrime()).array().map(nestLeft); };\nvar expressionPrime = function () { return parser_1.F.lazy(expressionNoApp).optrep(); };\nvar nestLeft = function (v) { return v.reduce(function (prev, cur) { return new App(prev, cur); }); };\nvar parser = genlex.use(expression().then(parser_1.F.eos().drop()).single());\nfunction parse(code, forResponse) {\n    if (forResponse === void 0) { forResponse = false; }\n    var response = parser.parse(parser_1.Streams.ofString(code));\n    if (forResponse)\n        return response;\n    if (response.isAccepted())\n        return response.value;\n    throw new ParseError('Failed to parse:\\n\\t' + code + '\\n\\t' + ' '.repeat(response.location()) + '^');\n}\nexports.parse = parse;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.apply = exports.infer = exports.unify = exports.combine = exports.substitute = exports.TypeInferenceError = void 0;\nvar language_1 = require(\"language\");\nvar TypeInferenceError = /** @class */ (function (_super) {\n    __extends(TypeInferenceError, _super);\n    function TypeInferenceError(message) {\n        var _this = _super.call(this, message) || this;\n        _this.name = \"TypeInferenceError\";\n        return _this;\n    }\n    return TypeInferenceError;\n}(Error));\nexports.TypeInferenceError = TypeInferenceError;\nfunction substitute(substitution, arg) {\n    var context = arg;\n    var mappedContext = {};\n    for (var key in context) {\n        mappedContext[key] = apply(context[key], substitution);\n    }\n    return mappedContext;\n}\nexports.substitute = substitute;\n/** Combines substitutions. Applies leftmost substitution first, e.g. combine(a, b).apply(e) == e.apply(a).apply(b) */\nfunction combine() {\n    var substitutions = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        substitutions[_i] = arguments[_i];\n    }\n    if (substitutions.length === 0)\n        return {};\n    if (substitutions.length === 1)\n        return substitutions[0];\n    if (substitutions.length > 2)\n        return combine(substitutions[0], combine.apply(void 0, substitutions.slice(1)));\n    var a = substitutions[0];\n    var b = substitutions[1];\n    var newSubstitution = {};\n    for (var key in a) {\n        newSubstitution[key] = apply(a[key], b);\n    }\n    for (var key in b) {\n        if (!(key in a)) {\n            newSubstitution[key] = b[key];\n        }\n    }\n    return newSubstitution;\n}\nexports.combine = combine;\nfunction unify(type1, type2) {\n    var _a;\n    if (type1 instanceof language_1.TypeVar) {\n        if (contains(type2, type1)) {\n            throw new TypeInferenceError('Contains/occurs check failed with ' + JSON.stringify(type1) + ' and ' + JSON.stringify(type2));\n        }\n        return _a = {}, _a[type1.name] = type2, _a;\n    }\n    if (type2 instanceof language_1.TypeVar) {\n        return unify(type2, type1);\n    }\n    if (type1 instanceof language_1.TypeFuncApp && type2 instanceof language_1.TypeFuncApp) {\n        if (type1.constructorName !== type2.constructorName) {\n            throw new TypeInferenceError('Could not unify type function applications with different constructors \\'' + type1.constructorName + '\\' and \\'' + type2.constructorName + '\\'');\n        }\n        if (type1.args.length !== type2.args.length) {\n            throw new TypeInferenceError('Could not unify type function applications with different argument list lengths ' + JSON.stringify(type1) + ' and ' + JSON.stringify(type2));\n        }\n        var sub = {};\n        for (var i = 0; i < type1.args.length; i++) {\n            sub = combine(unify(apply(type1.args[i], sub), apply(type2.args[i], sub)), sub);\n        }\n        return sub;\n    }\n    // Should be unreachable...\n    throw new Error('Internal error, this should never happen');\n}\nexports.unify = unify;\n/** a \\ b */\nfunction diff(a, b) {\n    var bset = new Set(b);\n    return a.filter(function (v) { return !bset.has(v); });\n}\nfunction freeVars(type) {\n    if (type instanceof language_1.PolyType) {\n        return diff(freeVars(type.monoType), type.quantifiedVars);\n    }\n    if (type instanceof language_1.TypeVar) {\n        return [type.name];\n    }\n    if (type instanceof language_1.TypeFuncApp) {\n        return type.args.map(freeVars).reduce(function (acc, cur) { return __spreadArrays(acc, cur); }, []);\n    }\n    if (type) {\n        // type: Context\n        return Object.values(type).map(freeVars).reduce(function (acc, cur) { return __spreadArrays(acc, cur); }, []);\n    }\n    // Should be unreachable...\n    throw new Error('Internal error, this should never happen');\n}\nfunction generalise(ctx, type) {\n    return new language_1.PolyType(diff(freeVars(type), freeVars(ctx)), type);\n}\nvar typeCounter = 0;\nfunction freshTypeName() {\n    return \"t\" + typeCounter++;\n}\nfunction freshType() {\n    return new language_1.TypeVar(freshTypeName());\n}\n// TODO: fallback to a default context instead of an empty one\nfunction infer(expr, ctx) {\n    if (ctx === void 0) { ctx = {}; }\n    return _infer(expr, ctx)[0];\n}\nexports.infer = infer;\nfunction _infer(expr, ctx) {\n    var _a, _b;\n    if (expr instanceof language_1.CharLiteral) {\n        return [inst(new language_1.PolyType([], new language_1.TypeFuncApp('char'))), {}];\n    }\n    if (expr instanceof language_1.NumberLiteral) {\n        return [inst(new language_1.PolyType([], new language_1.TypeFuncApp('number'))), {}];\n    }\n    if (expr instanceof language_1.Var) {\n        var type = ctx[expr.name];\n        if (!type) {\n            throw new TypeInferenceError(expr.name + ' is not in scope');\n        }\n        return [inst(type), {}];\n    }\n    if (expr instanceof language_1.App) {\n        var _c = _infer(expr.func, ctx), funcType = _c[0], funcSubstitution = _c[1];\n        var _d = _infer(expr.arg, substitute(funcSubstitution, ctx)), argType = _d[0], argSubstitution = _d[1];\n        var t = freshType();\n        var unifiedSubstitution = unify(apply(funcType, argSubstitution), new language_1.TypeFuncApp(\"->\", argType, t));\n        return [apply(t, unifiedSubstitution), combine(funcSubstitution, argSubstitution, unifiedSubstitution)];\n    }\n    if (expr instanceof language_1.Abs) {\n        var t = freshType();\n        var _e = _infer(expr.body, __assign(__assign({}, ctx), (_a = {}, _a[expr.param] = new language_1.PolyType([], t), _a))), bodyType = _e[0], bodySubstitution = _e[1];\n        return [apply(new language_1.TypeFuncApp(\"->\", t, bodyType), bodySubstitution), bodySubstitution];\n    }\n    if (expr instanceof language_1.Let) {\n        var _f = _infer(expr.def, ctx), defType = _f[0], defSubstitution = _f[1];\n        var _g = _infer(expr.body, __assign(__assign({}, substitute(defSubstitution, ctx)), (_b = {}, _b[expr.param] = generalise(substitute(defSubstitution, ctx), defType), _b))), bodyType = _g[0], bodySubstitution = _g[1];\n        return [bodyType, combine(defSubstitution, bodySubstitution)];\n    }\n    // Should be unreachable...\n    throw new Error('Internal error, this should never happen');\n}\nfunction inst(type, from, to) {\n    if (from === void 0) { from = []; }\n    if (to === void 0) { to = []; }\n    if (type instanceof language_1.TypeVar) {\n        var i = from.indexOf(type.name);\n        return (i === -1) ? type : new language_1.TypeVar(to[i]);\n    }\n    if (type instanceof language_1.TypeFuncApp) {\n        return new (language_1.TypeFuncApp.bind.apply(language_1.TypeFuncApp, __spreadArrays([void 0, type.constructorName], type.args.map(function (arg) { return inst(arg, from, to); }))))();\n    }\n    if (type instanceof language_1.PolyType) {\n        return inst(type.monoType, type.quantifiedVars, type.quantifiedVars.map(freshTypeName));\n    }\n    // Should be unreachable...\n    throw new Error('Internal error, this should never happen');\n}\nfunction apply(type, substitution) {\n    if (type instanceof language_1.TypeVar) {\n        return type.name in substitution ? substitution[type.name] : type;\n    }\n    if (type instanceof language_1.TypeFuncApp) {\n        return new (language_1.TypeFuncApp.bind.apply(language_1.TypeFuncApp, __spreadArrays([void 0, type.constructorName], type.args.map(function (arg) { return apply(arg, substitution); }))))();\n    }\n    if (type instanceof language_1.PolyType) {\n        return new language_1.PolyType(type.quantifiedVars, apply(type.monoType, substitution));\n    }\n    // Should be unreachable...\n    throw new Error('Internal error, this should never happen');\n}\nexports.apply = apply;\nfunction contains(type, other) {\n    if (type instanceof language_1.TypeVar) {\n        return type.name == other.name;\n    }\n    if (type instanceof language_1.TypeFuncApp) {\n        return type.args.some(function (arg) { return contains(arg, other); });\n    }\n    if (type instanceof language_1.PolyType) {\n        return contains(type.monoType, other) && !type.quantifiedVars.includes(other.name);\n    }\n    // Should be unreachable...\n    throw new Error('Internal error, this should never happen');\n}\n","import React, { useState } from 'react';\nimport './Main.css';\nimport { TypeVar, TypeFunc, TypeFuncApp, MonoType, PolyType, Expr, Var, App, Abs, Let, parse, ParseError, NumberLiteral, CharLiteral } from 'language'\nimport { Context, infer, TypeInferenceError } from 'algorithm-w'\n\n// Helper to make writing out the AST less painful\n// e('+', 'myNum', 'myNum')\n// will result in\n// new App(new App(v('+'), v('myNum')), new Var('myNum'))\nexport const e = (v: string | Expr, ...args: (string | Expr)[]): Expr => {\n  if (typeof v === 'string') {\n      if (args.length === 0) return new Var(v);\n  } else {\n      if (args.length === 0) return v;\n  }\n  return new App(e(v, ...args.slice(0, args.length - 1)), e(args[args.length - 1]));\n}\n\n// Utilities which make creating types easier\nexport const number = new TypeFuncApp('number');\nexport const boolean = new TypeFuncApp('boolean');\nexport const f = (one: MonoType, two: MonoType, ...extra: MonoType[]): TypeFuncApp => {\n    if (extra.length === 0) return new TypeFuncApp('->', one, two)\n    return new TypeFuncApp('->', one, f(two, extra[0], ...extra.slice(1)))\n}\nexport const list = (monoType: MonoType): TypeFuncApp => new TypeFuncApp('[]', monoType);\nexport const tuple = (...monoTypes: MonoType[]): TypeFuncApp => {\n    if (monoTypes.length <= 1) throw new Error('Tuple has too few elements, minimum of 2 but given ' + monoTypes.length)\n    if (monoTypes.length > 8) throw new Error('Tuple has too many elements, maximum of 8 but given ' + monoTypes.length)\n    return new TypeFuncApp(','.repeat(monoTypes.length - 1) as TypeFunc, ...monoTypes);\n}\nexport const maybe = (monoType: MonoType): TypeFuncApp => new TypeFuncApp('Maybe', monoType);\nexport const either = (left: MonoType, right: MonoType): TypeFuncApp => new TypeFuncApp('Either', left, right);\n\nexport const a = new TypeVar('a');\nexport const b = new TypeVar('b');\nexport const c = new TypeVar('c');\nexport const d = new TypeVar('d');\nconst pt = (mt: MonoType) => new PolyType([], mt);\n\n// Set up some basic things so the langauge is interesting\nexport const standardCtx: Context = {\n  // Arithmetic\n  '+': pt(f(number, number, number)),\n  '*': pt(f(number, number, number)),\n  '-': pt(f(number, number, number)),\n  '/': pt(f(number, number, number)),\n  '%': pt(f(number, number, number)),\n  'negate': pt(f(number, number)),\n  'abs': pt(f(number, number)),\n  'signum': pt(f(number, number)),\n  'even': pt(f(number, boolean)),\n  'odd': pt(f(number, boolean)),\n\n  // Booleans\n  'not': pt(f(boolean, boolean)),\n  '&&': pt(f(boolean, boolean, boolean)),\n  '||': pt(f(boolean, boolean, boolean)),\n  'True': pt(boolean),\n  'False': pt(boolean),\n\n  // Example variables\n  'myNumber': pt(number),\n  'myBoolean': pt(boolean),\n\n  // Lists\n  '[]': new PolyType(['a'], list(a)),\n  ':': new PolyType(['a'], f(a, list(a), list(a))),\n  'cons': new PolyType(['a'], f(a, list(a), list(a))),\n  '++': new PolyType(['a'], f(list(a), list(a), list(a))),\n  'head': new PolyType(['a'], f(list(a), a)),\n  'last': new PolyType(['a'], f(list(a), a)),\n  'tail': new PolyType(['a'], f(list(a), list(a))),\n  'init': new PolyType(['a'], f(list(a), list(a))),\n  'uncons': new PolyType(['a'], f(list(a), maybe(tuple(a, list(a))))),\n  'null': new PolyType(['a'], f(list(a), boolean)),\n  'length': new PolyType(['a'], f(list(a), number)),\n  'map': new PolyType(['a', 'b'], f(f(a, b), list(a), list(b))),\n  'reverse': new PolyType(['a'], f(list(a), list(a))),\n  'intersperse': new PolyType(['a'], f(a, list(a), list(a))),\n  'intercalate': new PolyType(['a'], f(list(a), list(list(a)), list(a))),\n  'transpose': new PolyType(['a'], f(list(list(a)), list(list((a))))),\n  'subsequences': new PolyType(['a'], f(list(a), list(list((a))))),\n  'permutations': new PolyType(['a'], f(list(a), list(list((a))))),\n  'foldl': new PolyType(['a'], f(f(b, a, b), b, list(a), b)),\n  'foldl\\'': new PolyType(['a'], f(f(b, a, b), b, list(a), b)),\n  'foldl1': new PolyType(['a'], f(f(a, a, a), list(a), a)),\n  'foldl1\\'': new PolyType(['a'], f(f(a, a, a), list(a), a)),\n  'foldr': new PolyType(['a'], f(f(a, b, b), b, list(a), b)),\n  'foldr1': new PolyType(['a'], f(f(a, a, a), list(a), a)),\n  'concat': new PolyType(['a'], f(list(list(a)), list(a))),\n  'concatMap': new PolyType(['a'], f(f(a, list(a)), list(a), list(b))),\n  'and': pt(f(list(boolean), boolean)),\n  'or': pt(f(list(boolean), boolean)),\n  'any': new PolyType(['a'], f(f(a, boolean), list(a), boolean)),\n  'all': new PolyType(['a'], f(f(a, boolean), list(a), boolean)),\n  'sum': pt(f(list(number), number)),\n  'product': pt(f(list(number), number)),\n  'maximum': pt(f(list(number), number)),\n  'minimum': pt(f(list(number), number)),\n  'take': new PolyType(['a'], f(number, list(a), list(a))),\n  'drop': new PolyType(['a'], f(number, list(a), list(a))),\n  'splitAt': new PolyType(['a'], f(number, list(a), tuple(list(a), list(a)))),\n  'takeWhile': new PolyType(['a'], f(f(a, boolean), list(a), list(a))),\n  'dropWhile': new PolyType(['a'], f(f(a, boolean), list(a), list(a))),\n  'elem': new PolyType(['a'], f(a, list(a), boolean)),\n  'notElem': new PolyType(['a'], f(a, list(a), boolean)),\n  'lookup': new PolyType(['a', 'b'], f(a, list(tuple(a, b)), maybe(b))),\n  'find': new PolyType(['a'], f(f(a, boolean), list(a), maybe(a))),\n  'filter': new PolyType(['a'], f(f(a, boolean), list(a), list(a))),\n  'partition': new PolyType(['a'], f(f(a, boolean), list(a), tuple(list(a), list(a)))),\n  '!!': new PolyType(['a'], f(list(a), number, a)),\n  'zip': new PolyType(['a', 'b'], f(list(a), list(b), list(tuple(a, b)))),\n  'zipWith': new PolyType(['a', 'b', 'c'], f(f(a, b, c), list(a), list(b), list(c))),\n  'unzip': new PolyType(['a', 'b'], f(list(tuple(a, b)), tuple(list(a), list(b)))),\n  'nub': new PolyType(['a'], f(list(a), list(a))),\n  'delete': new PolyType(['a'], f(a, list(a), list(a))),\n  '\\\\\\\\': new PolyType(['a'], f(list(a), list(a), list(a))),\n  'union': new PolyType(['a'], f(list(a), list(a), list(a))),\n  'intersect': new PolyType(['a'], f(list(a), list(a), list(a))),\n  'sort': new PolyType(['a'], f(list(a), list(a))),\n\n  // Tuples\n  ',': new PolyType(['a', 'b'], f(a, b, tuple(a, b))),\n  ',,': new PolyType(['a', 'b', 'c'], f(a, b, c, tuple(a, b, c))),\n  ',,,': new PolyType(['a', 'b', 'c', 'd'], f(a, b, c, d, tuple(a, b, c, d))),\n  'fst': new PolyType(['a', 'b'], f(tuple(a, b), a)),\n  'snd': new PolyType(['a', 'b'], f(tuple(a, b), b)),\n  'curry': new PolyType(['a', 'b', 'c'], f(f(tuple(a, b), c), a, b, c)),\n  'uncurry': new PolyType(['a', 'b', 'c'], f(f(a, b, c), tuple(a, b), c)),\n\n  // Maybe\n  'Just': new PolyType(['a'], f(a, maybe(a))),\n  'Nothing': new PolyType(['a'], maybe(a)),\n  \n  // Either\n  'Left': new PolyType(['a', 'b'], f(a, either(a, b))),\n  'Right': new PolyType(['a', 'b'], f(b, either(a, b))),\n}\n\nfunction Main() {\n  const [code, setCode] = useState('map not []');\n  let result = 'Error: ';\n  try {\n    const r = parse(code);\n    if (!(r instanceof CharLiteral) && !(r instanceof NumberLiteral) && !(r instanceof Var) && !(r instanceof App) && !(r instanceof Abs) && !(r instanceof Let)) {\n      throw new Error('Not a valid expression');\n    }\n    result = infer(r, standardCtx).toString();\n  } catch (e) {\n    if (e.name === TypeInferenceError.name) {\n      result += (e as TypeInferenceError).message;\n    } else if (e.name === ParseError.name) {\n      result += (e as ParseError).message;\n    } else {\n      result += 'Not a valid expression: ' + e.message;\n    }\n  }\n\n  return (\n    <>\n      <h1>interactive type inference</h1>\n      <h2>\n        Play with algorithm W in your browser.\n      </h2>\n      <h2>Samples:\n        <button onClick={() => setCode('4')}>4</button>\n        <button onClick={() => setCode('+')}>+</button>\n        <button onClick={() => setCode('map not []')}>map not []</button>\n        <button onClick={() => setCode('fst')}>fst</button>\n        <button onClick={() => setCode('Just')}>Just</button>\n      </h2>\n      <textarea placeholder=\"Enter code here...\" value={code} onChange={e => setCode(e.target.value)}></textarea>\n      <h2>Result</h2>\n      <p>{result}</p>\n    </>\n  );\n}\n\nexport default Main;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport Main from './Main';\n\nReactDOM.render(\n  <React.StrictMode>\n    <Main />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}